# pyOCD debugger
# Copyright (c) 2022 PyOCD Authors
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

from ...coresight.coresight_target import CoreSightTarget
from ...core.memory_map import (FlashRegion, RamRegion, MemoryMap)

FLASH_ALGO = {
    'load_address' : 0x20000000,

    # Flash algorithm as a hex string
    'instructions': [
    0xe7fdbe00,
    0xf240b580, 0xf2c00004, 0xf2400000, 0x44480118, 0x0100f2c0, 0x0001f849, 0xf2c42018, 0x68026002,
    0xf3632307, 0x60024295, 0x0001f859, 0x22002100, 0xfaa2f000, 0xbd802000, 0x0218f240, 0xf2c02100,
    0x20000200, 0x1002f849, 0xb5104770, 0x0418f240, 0x0400f2c0, 0x0004f859, 0xf0002100, 0xf240fc1d,
    0xf2c0011c, 0xf8590100, 0xf8590004, 0x21002001, 0xfb5ef000, 0x0004f859, 0xf0002101, 0x2000fc0d,
    0xb570bd10, 0x5fc0f1b0, 0x4605d322, 0x001cf240, 0x0000f2c0, 0x0000f859, 0x50c0f100, 0xd91742a8,
    0x0618f240, 0x0600f2c0, 0x0006f859, 0x24002100, 0xfbf2f000, 0x0006f859, 0x4168f105, 0x5280f44f,
    0xfb36f000, 0x0006f859, 0xf0002101, 0xe000fbe5, 0x46202401, 0xe92dbd70, 0xf1b041f0, 0xd3285fc0,
    0xf2404607, 0xf2c0001c, 0xf8590000, 0x24010000, 0x50c0f100, 0xd91d42b8, 0x4439460e, 0xd8194281,
    0x0818f240, 0x0800f2c0, 0x0008f859, 0x46152100, 0xf0002400, 0xf859fbc1, 0xf1070008, 0x462a4168,
    0xf0004633, 0xf859faa3, 0x21010008, 0xfbb4f000, 0x2401e000, 0xe8bd4620, 0xb58081f0, 0x5fc0f1b0,
    0xf240d318, 0xf2c0031c, 0xf8590300, 0xf04f3003, 0xf1030e01, 0x45845cc0, 0x180bd90e, 0xd80b4563,
    0x42937803, 0x3901d106, 0x0001f100, 0xf04fd1f8, 0xe0010e00, 0x0e01f04f, 0xbd804670, 0x45f0e92d,
    0xf1b0b0a1, 0xd32e5fc0, 0xf240460f, 0xf2c0011c, 0xf8590100, 0x26011001, 0x51c0f101, 0xd9234281,
    0x183a4614, 0xd81f428a, 0x0a18f240, 0x0804f10d, 0x0a00f2c0, 0xbf004606, 0x2f80463d, 0x2580bf28,
    0x000af859, 0x4168f106, 0x462b4642, 0xf9eff000, 0x46214640, 0xf001462a, 0xb928f885, 0x1b7f442e,
    0xd1e9442c, 0x2601e000, 0xb0214630, 0x85f0e8bd, 0x4df0e92d, 0x4606b084, 0x79446807, 0x46922000,
    0xf88d468b, 0xf8ad000e, 0xad03000c, 0x46309000, 0x22002101, 0x95012300, 0xfb62f000, 0xb004b110,
    0x8df0e8bd, 0x100ef89d, 0xd3112918, 0x73302001, 0x21021e48, 0xf000fa01, 0x011cf240, 0x0100f2c0,
    0x0001f849, 0x7180f240, 0x0103f2c0, 0xe0152000, 0x23023901, 0xfa037b32, 0xf240f101, 0xf2c0031c,
    0xfab20300, 0xf849f082, 0xf2401003, 0x09407180, 0x0103f2c0, 0xbf082a00, 0x3180f5a1, 0x6c396139,
    0x01fff021, 0x64394421, 0x4630b918, 0xf0002101, 0x7930fd14, 0xd10a2804, 0xf0004630, 0x2800fe4d,
    0x7b30d1bd, 0xbf0c2800, 0x200d2005, 0x4630e009, 0xfe70f000, 0xd1b22800, 0x28007b30, 0x2001bf0c,
    0xf2402009, 0x65380830, 0x000bea5a, 0x5800f2cf, 0xf04fbf08, 0xf1bb4875, 0xbf180f00, 0x0f00f1ba,
    0xf1bbd10d, 0xd01a0f00, 0x0f00f1ba, 0x4630d117, 0xfeacf000, 0xd1922800, 0x8080f8c7, 0xf10de00c,
    0x4630010f, 0xfed0f000, 0xf47f2800, 0xf8c7af88, 0xf89d8080, 0xb980000f, 0x280beb0b, 0xf1bbe00f,
    0xd10f0f00, 0x0f00f1ba, 0x4630d00c, 0xfe60f000, 0xf47f2800, 0xf8c7af74, 0xeb0a8080, 0x2000280a,
    0xe0032190, 0xf0004630, 0x2180fe81, 0x8001f847, 0x6101e765, 0x6c004770, 0x64014770, 0x69004770,
    0x69404770, 0x61414770, 0x6b004770, 0x63014770, 0x6b404770, 0x6b804770, 0x63814770, 0x6bc04770,
    0x63c14770, 0x6a004770, 0x62014770, 0x6a404770, 0x62414770, 0x6a804770, 0x62814770, 0x6ac04770,
    0x62c14770, 0xb5104770, 0xf04fb088, 0xea045400, 0xf04f7141, 0xea046470, 0xf04f6202, 0xea0e4e80,
    0xf8dd7080, 0xe9cde028, 0xf24f1201, 0xf2c00100, 0xf44f011f, 0xf8dd62c0, 0xea01c02c, 0xea023103,
    0xf36f224e, 0xe9cd2c5f, 0x21011203, 0x9000466a, 0xc014f8cd, 0x3021f852, 0x29063101, 0x0003ea40,
    0xb008d1f8, 0xb5f0bd10, 0xf04fb089, 0xea075700, 0xf04f7741, 0xea016170, 0xf04f6202, 0xe9cd4680,
    0xf24f7201, 0xea060200, 0x9e0e7080, 0x021ff2c0, 0x540fe9dd, 0x3203ea02, 0x63c0f44f, 0x2346ea03,
    0xec11e9dd, 0x2303e9cd, 0x5280f04f, 0x7204ea02, 0x255ff36f, 0x1300f44f, 0x5205e9cd, 0x528eea4f,
    0x534cea03, 0xfa3f4669, 0x3104f282, 0x2307e9cd, 0x90002200, 0x3022f851, 0x2a083201, 0x0003ea40,
    0xb009d1f8, 0x6800bdf0, 0x6b404770, 0x0001f000, 0xf2404770, 0xbf0031e7, 0x07d26b42, 0x2000bf04,
    0x39014770, 0xf04fbf04, 0x477030ff, 0x6b40e7f4, 0x4080f400, 0xf2404770, 0xbf0031e7, 0x04526b42,
    0x2000bf5c, 0x39014770, 0xf04fbf04, 0x477030ff, 0x6b40e7f4, 0x2004f3c0, 0x6b014770, 0x0106f041,
    0x47706301, 0x210062c1, 0x62416202, 0x62034770, 0x62416282, 0xbf004770, 0x07d26b42, 0x6b42d00e,
    0xd4f90452, 0xf3c26b42, 0x2a002204, 0xbf00d0f4, 0x3a016ac3, 0x3b04f841, 0xe7edd1fa, 0xf3c26b42,
    0xb1222204, 0x3a016ac3, 0x3b04f841, 0x4770d1fa, 0x1d93b580, 0xd31e2b07, 0x17d33203, 0x7293eb02,
    0x0c01f04f, 0xf04f1093, 0x2b010e00, 0xea4fbf88, 0xbf000ca2, 0x52faf44f, 0xbf00e003, 0xbf083a01,
    0x6b43bd80, 0xd4f9021b, 0x2b04f851, 0x0e01f10e, 0x62c245e6, 0xbd80d1ee, 0x4604b510, 0x28006880,
    0x0001f04f, 0xd10471e0, 0x7020f64b, 0x0002f2c0, 0x79a060a0, 0x2028b110, 0x8811f380, 0xf7ff4620,
    0x79a1fe27, 0x2100b111, 0x8811f381, 0xb510bd10, 0x4604b180, 0xb1107980, 0xf3802028, 0x46208811,
    0xf80bf000, 0x290079a1, 0xbd10bf08, 0xf3812100, 0xbd108811, 0x30fff04f, 0xe92dbd10, 0xb08145f0,
    0xf012468a, 0x46140103, 0xf1c1bf18, 0x1a5a0104, 0xf04f461e, 0xbf880700, 0xbf88460e, 0x0703f022,
    0xf04f428b, 0xbf880500, 0x0503f002, 0xb16e4680, 0x4640466a, 0x46334651, 0xfc0ff000, 0x4669bb18,
    0x46324620, 0xfe8af000, 0x44b24434, 0x4640b147, 0x46224651, 0xf000463b, 0xb9a0fc00, 0x44ba443c,
    0x466ab185, 0x46514640, 0xf000462b, 0xb110fbf6, 0x30fff04f, 0x4668e007, 0x1b01f810, 0xf8043d01,
    0xd1f91b01, 0xb0012000, 0x85f0e8bd, 0xb110b510, 0x79c04604, 0xf04fb110, 0xbd1030ff, 0xb11079a0,
    0xf3802028, 0x46208811, 0xf808f000, 0x290079a1, 0xbd10bf08, 0xf3812100, 0xbd108811, 0x4df0e92d,
    0x468ab082, 0x0103f012, 0xbf184615, 0x0104f1c1, 0x461c1a5a, 0x0700f04f, 0x460cbf88, 0xf022bf88,
    0x428b0703, 0x0600f04f, 0xf002bf88, 0x46800603, 0xf10db17c, 0x46580b04, 0x46224629, 0xfe2ef000,
    0x46514640, 0x4623465a, 0xfb70f000, 0x4425b948, 0xb15f44a2, 0x46514640, 0x463b462a, 0xfb66f000,
    0xf04fb110, 0xe01030ff, 0x44ba443d, 0xb1662000, 0xbf00a901, 0x540a5c2a, 0x42863001, 0xaa01d1fa,
    0x46514640, 0xf0004633, 0xb002fb51, 0x8df0e8bd, 0xb110b510, 0x79c04604, 0xf04fb110, 0xbd1030ff,
    0xb11079a0, 0xf3802028, 0x46208811, 0xf808f000, 0x290079a1, 0xbd10bf08, 0xf3812100, 0xbd108811,
    0x4df0e92d, 0x4604b084, 0x70fff640, 0x0500ea21, 0x311ff36f, 0xf6001850, 0xea4f7bff, 0x2700301b,
    0xbf009002, 0x42879802, 0x4620d23c, 0xfa64f000, 0xf5bbbba8, 0xd3093f80, 0x4070f415, 0xf04fd106,
    0xf44f0a10, 0x21113880, 0xbf00e018, 0x41e0f405, 0x30dbea5f, 0xf181fab1, 0x2001bf18, 0x40080949,
    0x0105f04f, 0x5880f44f, 0x2110bf18, 0x0a01f04f, 0xf44fbf18, 0xbf184800, 0x0a08f04f, 0x90002000,
    0x462a4620, 0xae032300, 0xf0009601, 0xb930f879, 0x44574620, 0xf0004445, 0x2800faa9, 0xf04fd0c2,
    0xe00030ff, 0xb0042000, 0x8df0e8bd, 0xb110b510, 0x79c04604, 0xf04fb110, 0xbd1030ff, 0xb11079a0,
    0xf3802028, 0x46208811, 0xf808f000, 0x290079a1, 0xbd10bf08, 0xf3812100, 0xbd108811, 0x41f0e92d,
    0x4604b084, 0xf081fa52, 0x05fff021, 0x210130ff, 0x2610eb01, 0x080cf10d, 0xbf002700, 0xd0173e01,
    0xf0004620, 0xb980f9f9, 0x21144620, 0x2300462a, 0xf8cd9700, 0xf0008004, 0xb930f833, 0xf5054620,
    0xf0007580, 0x2800fa63, 0xf04fd0e8, 0xe00030ff, 0xb0042000, 0x81f0e8bd, 0xbf0e2800, 0x30fff04f,
    0x200071c1, 0xf04f4770, 0x477030ff, 0x70fff640, 0x5c80f44f, 0x0000ea21, 0xe9c20b0b, 0x20000c00,
    0x47706093, 0xf44fb2c0, 0xea02427f, 0xea402211, 0xf4016001, 0x4410417f, 0x2001ea40, 0xbf004770,
    0x4df0e92d, 0xf8d0b086, 0x4605b000, 0x461f4658, 0x460e4692, 0xfdcdf7ff, 0xf0402800, 0x46588164,
    0xfdebf7ff, 0xf04f2e14, 0xf20030ff, 0xf8dd815e, 0x21018038, 0xe8df2405, 0x0015f016, 0x01050031,
    0x004c003f, 0x005f0059, 0x00c40088, 0x008f00dc, 0x009c0158, 0x00a900b4, 0x00ad00ab, 0x010400ec,
    0x00bd00b3, 0x28027928, 0x8105f000, 0xf0402804, 0x1e788117, 0x21022601, 0x6000e9cd, 0x6102e9cd,
    0x21012001, 0x23002209, 0xf7ff9604, 0x4603fd4c, 0x21ec7b28, 0xbf082800, 0xe11421eb, 0x25002002,
    0x20009001, 0x22032100, 0x95002300, 0xfd0bf7ff, 0x46584602, 0xe0d1219f, 0x20002500, 0x22012100,
    0x95002300, 0xf7ff9501, 0x4602fcfe, 0x21064658, 0x2500e08c, 0x21002000, 0x23002201, 0x95019500,
    0xfcf1f7ff, 0x46584602, 0xe07f2104, 0x24217b28, 0xbf082800, 0xe0912420, 0x7b297928, 0xfab21f02,
    0x0952f282, 0x24342312, 0xbf082900, 0xbf082302, 0x00512432, 0x28042500, 0x461cbf18, 0xe9cd1e7b,
    0x20015102, 0x22012101, 0x5500e9cd, 0xf7ff9504, 0x4603fcfa, 0x46214658, 0xf7ff4652, 0x4658fd68,
    0x463a4641, 0xfd84f7ff, 0xfa3fe0c7, 0xf40af18a, 0xf101407f, 0xe03a5158, 0x20002500, 0x22032100,
    0x95002300, 0xf7ff9501, 0x4602fcae, 0x212b4658, 0x2500e074, 0x21002000, 0x23002201, 0x95019500,
    0xfca1f7ff, 0x46584602, 0xe02f2198, 0xe0592435, 0xe0062131, 0x245c7b28, 0xbf082800, 0xe03d2452,
    0xea412111, 0x2500240a, 0x21002000, 0x23012201, 0xe0159500, 0xf18afa3f, 0x407ff40a, 0x4101f101,
    0xfa3fe005, 0xf40af18a, 0xf101407f, 0xba095164, 0xea412500, 0x95002400, 0x21002000, 0x23032201,
    0xf7ff9501, 0x4602fc70, 0x46214658, 0xfd0af7ff, 0xfa3fe073, 0xf101f18a, 0xf40a5170, 0xba09407f,
    0xea412500, 0x95002400, 0x21002000, 0x23032203, 0x7b28e01e, 0x280024dc, 0x24d8bf08, 0x20012500,
    0x22072101, 0xe9cd2300, 0xe9cd5500, 0x95045502, 0xfc79f7ff, 0x46584603, 0x46524621, 0xfce7f7ff,
    0x2415e04b, 0x20002500, 0x22032100, 0x95002300, 0xf7ff9501, 0x4602fc38, 0x46214658, 0xfcd2f7ff,
    0xf7ff4658, 0xb108fcb8, 0xe0374606, 0xf7ff4658, 0x4605fc26, 0x1e78e031, 0x21012600, 0x6000e9cd,
    0x1102e9cd, 0x21012001, 0x23002209, 0xf7ff9604, 0x4603fc4a, 0x21bc7b28, 0xbf082800, 0xe01221bb,
    0x26001e78, 0x6000e9cd, 0x21012001, 0x23002209, 0x6602e9cd, 0xf7ff9604, 0x4603fc36, 0x210c7b28,
    0xbf082800, 0x4658210b, 0xf7ff4652, 0x4658fca0, 0x463a4641, 0xfc9ff7ff, 0x26002500, 0xf7ff4658,
    0x4330fc68, 0xf04fd004, 0xb00630ff, 0x8df0e8bd, 0x6005980f, 0xe7f82000, 0xb083b5f0, 0x68044606,
    0x2500460f, 0x21002000, 0x23002203, 0x95019500, 0xfbd9f7ff, 0x46204602, 0xf7ff21c8, 0x4620fc73,
    0xfc59f7ff, 0x4620b938, 0xfbc9f7ff, 0x6f17ebb0, 0x2000d101, 0x4630e005, 0xf81ef000, 0xf04fb118,
    0xb00330ff, 0x20c5bdf0, 0x4017ea40, 0xf0202700, 0x2000053a, 0x22012100, 0x97002301, 0xf7ff9701,
    0x4602fbb2, 0x46294620, 0xfc4cf7ff, 0xb0034620, 0x40f0e8bd, 0xbc1df7ff, 0xb083b5f0, 0x20004604,
    0x9000ad02, 0x21034620, 0x23002200, 0xf7ff9501, 0xb110fe37, 0x30fff04f, 0x68a0e01d, 0xd3162802,
    0x27002601, 0x21024620, 0x23002200, 0x95019700, 0xfe26f7ff, 0xd1ed2800, 0xf0109802, 0xd1e90f3c,
    0xd4050781, 0x360168a1, 0xd3eb428e, 0x9802e000, 0x0040f3c0, 0xb0033801, 0xb5b0bdf0, 0x6804b082,
    0x290025b7, 0x25e9bf08, 0x0c00f04f, 0x21002000, 0x23002201, 0xc000f8cd, 0xc004f8cd, 0xfb63f7ff,
    0x46204602, 0xf7ff4629, 0x4620fbfd, 0xe8bdb002, 0xf7ff40b0, 0xb570bbce, 0x4604b084, 0xffacf7ff,
    0x2000b9c0, 0x9000ae03, 0x210c4620, 0x23002200, 0xf7ff9601, 0xb968fde5, 0xf0004620, 0xb948f817,
    0x46202500, 0x22002109, 0x96012300, 0xf7ff9500, 0xb120fdd7, 0x35fff04f, 0xb0044628, 0xf89dbd70,
    0x28ff000c, 0xf04fbf08, 0xe7f535ff, 0xb083b5f0, 0x68804605, 0x28022400, 0xd3199402, 0xaf022601,
    0x21024628, 0x23002200, 0x97019400, 0xfdb8f7ff, 0x9802b960, 0xd0030781, 0x360168a9, 0xd3ef428e,
    0x0403f010, 0xf04fbf18, 0xe00134ff, 0x34fff04f, 0xb0034620, 0xb5b0bdf0, 0x6805b084, 0x46284604,
    0xfad9f7ff, 0x01fff040, 0xf7ff4628, 0x4628fad6, 0xfad1f7ff, 0xad032000, 0x46209000, 0x22002101,
    0x95012300, 0xfd8cf7ff, 0xbdb0b004, 0x45f0e92d, 0x461cb083, 0x460e4615, 0xf10d4680, 0xbf000a08,
    0xf5c0b2f0, 0x46407780, 0xbf8842a7, 0xf7ff4627, 0xb998ff33, 0x21064640, 0x463b4632, 0xf8cd9500,
    0xf7ffa004, 0xb948fd6d, 0xf7ff4640, 0xb928ff9f, 0x1be4443e, 0xd1e3443d, 0xe0012000, 0x30fff04f,
    0xe8bdb003, 0x2a0185f0, 0x4770bfb8, 0x3b01f811, 0xf8003a01, 0xd1f93b01, 0xe92d4770, 0xb08345f0,
    0x461fb1d3, 0x460e4615, 0xf10d4680, 0xbf000a08, 0xf5b7463c, 0xbf287f00, 0x7400f44f, 0x21004640,
    0x46234632, 0xf8cd9500, 0xf7ffa004, 0xb928fd39, 0x1b3f4426, 0xd1eb4425, 0xe0012000, 0x30fff04f,
    0xe8bdb003, 0xb57085f0, 0x2500b084, 0x2102ae03, 0x23002200, 0x95034604, 0x96019500, 0xfd20f7ff,
    0xf0409803, 0x4620013c, 0xf80bf000, 0x21024620, 0x23002200, 0x96019500, 0xfd12f7ff, 0xb0042000,
    0xb5b0bd70, 0x460db084, 0xf7ff4604, 0xb960fec5, 0xf10d2000, 0x90000c0c, 0x210d4620, 0x2300462a,
    0xc004f8cd, 0xfcfcf7ff, 0xf04fb118, 0xb00430ff, 0x4620bdb0, 0xe8bdb004, 0xe72740b0, 0xb084b570,
    0xae032500, 0x22002102, 0x46042300, 0x95009503, 0xf7ff9601, 0x9803fce5, 0x013cf020, 0xf7ff4620,
    0x4620ffd0, 0x22002102, 0x95002300, 0xf7ff9601, 0x2000fcd7, 0xbd70b004, 0xb084b5b0, 0x20004604,
    0x9000ad02, 0x210e4620, 0x23002200, 0xf7ff9501, 0xb118fcc7, 0x30fff04f, 0xbdb0b004, 0x07a89d02,
    0x4620d416, 0xfe78f7ff, 0xd1f32800, 0xf0452000, 0xad030202, 0x46209000, 0x2300210f, 0xf7ff9501,
    0x2800fcaf, 0x4620d1e6, 0xe8bdb004, 0xe6dd40b0, 0xe7e12000, 0xb084b5b0, 0x20004604, 0x9000ad02,
    0x210e4620, 0x23002200, 0xf7ff9501, 0xb118fc99, 0x30fff04f, 0xbdb0b004, 0x07a89d02, 0x2000d401,
    0x4620e7f8, 0xfe48f7ff, 0xd1f12800, 0xf0252000, 0xad030202, 0x46209000, 0x2300210f, 0xf7ff9501,
    0x2800fc7f, 0x4620d1e4, 0xe8bdb004, 0xe6ad40b0, 0xb084b5b0, 0x20004604, 0x9000ad02, 0x21124620,
    0x23002200, 0xf7ff9501, 0xb118fc6b, 0x30fff04f, 0xbdb0b004, 0x07e89d02, 0x4620d116, 0xfe1cf7ff,
    0xd1f32800, 0xf0452000, 0xad030201, 0x46209000, 0x23002113, 0xf7ff9501, 0x2800fc53, 0x4620d1e6,
    0xe8bdb004, 0xe68140b0, 0xe7e12000, 0xb084b5b0, 0x20004604, 0x9000ad02, 0x21124620, 0x23002200,
    0xf7ff9501, 0xb118fc3d, 0x30fff04f, 0xbdb0b004, 0x07e89d02, 0x2000d101, 0x4620e7f8, 0xfdecf7ff,
    0xd1f12800, 0xf0252000, 0xad030201, 0x46209000, 0x23002113, 0xf7ff9501, 0x2800fc23, 0x4620d1e4,
    0xe8bdb004, 0xe65140b0, 0xb084b5b0, 0x2100460d, 0x9100ac03, 0x22002112, 0x94012300, 0xfc10f7ff,
    0xf89db920, 0xf001100c, 0x70290101, 0xbdb0b004, 0xb348b510, 0xd04a2801, 0xd16e2802, 0xf2c4200c,
    0x68026020, 0xf3632303, 0x60020204, 0xf2c4203c, 0x68426000, 0xf3632301, 0x60425216, 0xf3636842,
    0x604252d9, 0xf0426842, 0x60426280, 0xf4426842, 0x60422200, 0xf2c42000, 0xf2405010, 0xf5000214,
    0xf2c01080, 0xe0450200, 0xf2c4200c, 0x68026020, 0xf3632302, 0x60020204, 0xf2c4203c, 0x68026000,
    0x5216f363, 0x68026002, 0xf3632301, 0x600252d9, 0xf0426802, 0x60026280, 0xf4426802, 0x60022200,
    0x0214f240, 0x0200f2c0, 0x408af04f, 0x200ce022, 0x6020f2c4, 0x23036802, 0x0204f363, 0x203c6002,
    0x6000f2c4, 0x23016842, 0x1206f363, 0x68426042, 0x12c9f363, 0x68426042, 0x6280f442, 0x68426042,
    0x0208f042, 0xf2406042, 0x20000214, 0x0200f2c0, 0x5010f2c4, 0x0002f849, 0xf240e005, 0xf2c00014,
    0xf8590000, 0xf2430000, 0x01096e00, 0x1e6ef2c0, 0xf2f1fbbe, 0x0c00f04f, 0x2300f64c, 0xc004f8c0,
    0x0c01f102, 0x6391f6cf, 0x3301fb0c, 0x2b0068c4, 0xfb0cbf48, 0xfb02e311, 0xf044e111, 0x60c40480,
    0xbfc84299, 0xb2d14662, 0x2207f3c2, 0x60426001, 0xf02168c1, 0x60c10180, 0xf02168c1, 0x60c10108,
    0xf04168c1, 0x60c10103, 0xf02168c1, 0x60c10104, 0x60812120, 0xf0416881, 0x60810101, 0xf240bd10,
    0xf2c00114, 0xf8590100, 0xbf001001, 0x0652694a, 0x6008d5fc, 0x78014770, 0xf240b171, 0xf2c00214,
    0xf8590200, 0xbf002002, 0x065b6953, 0x6011d5fc, 0x1f01f810, 0xd1f72900, 0xb5804770, 0x2200b081,
    0x2002f88d, 0x0230f647, 0x2000f8ad, 0x0214f240, 0x0200f2c0, 0x2002f859, 0xf04f46ec, 0xbf000e30,
    0x065b6953, 0xf8c2d5fc, 0xf81ce000, 0xf1beef01, 0xd1f50f00, 0xd4133904, 0xf301fa20, 0x0e0ff003,
    0x0c37f10e, 0x065b6953, 0xf1bed5fc, 0xbf380f0a, 0x0c30f10e, 0xf1b13904, 0xf8c23fff, 0xdcebc000,
    0xbd80b001, 0x0301ea40, 0x079bb510, 0x2a04d10f, 0xc810d30d, 0x1f12c908, 0xd0f8429c, 0xba19ba20,
    0xd9014288, 0xbd102001, 0x30fff04f, 0xb11abd10, 0xd00307d3, 0xe0071c52, 0xbd102000, 0x3b01f810,
    0x4b01f811, 0xd1071b1b, 0x3b01f810, 0x4b01f811, 0xd1011b1b, 0xd1f11e92, 0xbd104618, 0xf2402a03,
    0xf0108030, 0xf0000c03, 0xf8118015, 0xf1bc3b01, 0x44620f02, 0xf811bf98, 0xf800cb01, 0xbf383b01,
    0x3b01f811, 0x0204f1a2, 0xf800bf98, 0xbf38cb01, 0x3b01f800, 0x0303f011, 0x8025f000, 0xf0c03a08,
    0xf8518008, 0x3a083b04, 0xcb04f851, 0x1008e8a0, 0x1d12e7f5, 0xf851bf5c, 0xf8403b04, 0xf3af3b04,
    0x07d28000, 0xf811bf24, 0xf8113b01, 0xbf48cb01, 0x2b01f811, 0xf800bf24, 0xf8003b01, 0xbf48cb01,
    0x2b01f800, 0xb5104770, 0xf0c03a20, 0xe8b1800b, 0xe8a05018, 0xe8b15018, 0xe8a05018, 0x3a205018,
    0xaff5f4bf, 0x7c02ea5f, 0xe8b1bf24, 0xe8a05018, 0xbf445018, 0xc018c918, 0x4010e8bd, 0x7c82ea5f,
    0xf851bf24, 0xf8403b04, 0xbf083b04, 0x07d24770, 0xf831bf28, 0xbf483b02, 0x2b01f811, 0xf820bf28,
    0xbf483b02, 0x2b01f800, 0x78304770, 0x00000000, 0x00000000, 0x46400000, 0x0000ff04, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000
    ],

    # Relative function addresses
    'pc_init': 0x20000005,
    'pc_unInit': 0x2000003d,
    'pc_program_page': 0x200000db,
    'pc_erase_sector': 0x20000087,
    'pc_eraseAll': 0x2000004f,

    'static_base' : 0x20000000 + 0x00000004 + 0x00001430,
    'begin_stack' : 0x20001648,
    'begin_data' : 0x20000000 + 0x1000,
    'page_size' : 0x1000,
    'analyzer_supported' : False,
    'analyzer_address' : 0x00000000,
    'page_buffers' : [0x20001000, 0x20002000],   # Enable double buffering
    'min_program_length' : 0x1000,

    # Relative region addresses and sizes
    'ro_start': 0x0,
    'ro_size': 0x1430,
    'rw_start': 0x1430,
    'rw_size': 0x14,
    'zi_start': 0x1444,
    'zi_size': 0xc,

    # Flash information
    'flash_start': 0x18000000,
    'flash_size': 0x2000000,
    'sector_sizes': (
        (0x0, 0x1000),
    )
}

class CSK6(CoreSightTarget):

    VENDOR = "LISTENAI"
    
    MEMORY_MAP = MemoryMap(
        FlashRegion(start=0x18000000, length=0x2000000, sector_size=0x1000,
                        page_size=0x100,
                        is_boot_memory=True,
                        algo=FLASH_ALGO),
        RamRegion(  start=0x00080000, length=0x50000)
        )

    def __init__(self, session):
        super(CSK6, self).__init__(session, self.MEMORY_MAP)
